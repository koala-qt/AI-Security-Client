webpackJsonp([20],{"12We":function(e,t){},ltlz:function(e,t){},xeWh:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("mvHQ"),i=a.n(s),n=a("//Fk"),o=a.n(n),r=a("4syG"),c=a("C6kd"),l=a("T+uA"),d=a("2hMI"),p={name:"access_records",components:{separator:r.a},data:function(){return{detailArr1:[{name:this.$t("personInf.name"),property:"name"},{name:this.$t("personInf.code"),property:"code"},{name:this.$t("personInf.sex"),property:"sex"},{name:this.$t("personInf.id"),property:"idcard"},{name:this.$t("personInf.email"),property:"email"},{name:this.$t("personInf.phone"),property:"phone"},{name:this.$t("personInf.type"),property:"personType"},{name:this.$t("personInf.organization"),property:"organization"}],detailArr2:[{name:this.$t("accessRecords.detailsAlert.time"),property:"recordDate"},{name:this.$t("accessRecords.detailsAlert.equipment"),property:"deviceName"},{name:this.$t("accessRecords.detailsAlert.inOut"),property:"divergenceType"},{name:this.$t("accessRecords.detailsAlert.passageWay"),property:"passageWay"},{name:this.$t("accessRecords.detailsAlert.results"),property:"validateResult"}],tableData:[],accessrecordsdialogVisible:!1,tableDataLabel:null,searchConfig:null,detailsShow:{},batchdisabled:!0,multipleSelection:[],detailsDialog:!1,tableBoxLoading:!1,shouwDetails:null,netAPI:"",deviceAPI:"",pageSize:5,total:0,currentPage:1,personId:"",AccessResultType:"",personType:"",divergenceType:"",deviceType:[],divergenceId:"",persondetail:{},snapPhoto:"",imageUrl:"",date:"",env:"",searchParam:{sn:"",startDate:"",endDate:"",personType:"",field:"",pageNo:1,pageSize:5},getRowKeys:function(e){return e.id}}},created:function(){this.netAPI=Object(d.a)().get("access_records"),this.deviceAPI=Object(d.a)().get("device"),this.peopleAPI=Object(d.a)().get("people_manage"),this.getPersonType(),this.findAccessResult(),this.findAccessCategory(),this.findDevice(),this.searchData(),this.env="production"},mounted:function(){this.tableDataLabel=c.a.get("access_records"),this.searchConfig=l.a.get("access_records")},methods:{filterselectable:function(e,t){return this.$route.meta.remove?1:0},changeDate:function(e){console.log(this.date)},filterTbale:function(e,t,a,s){for(var i=0;i<this.personType.length;i++)if(this.personType[i].no==e.personType)return this.personType[i].name},filterTbale2:function(e){switch(e.divergenceType){case"1":return"成功";case"2":return"失败"}},handleSelectionChange:function(e){e.length>0?this.batchdisabled=!1:this.batchdisabled=!0,this.multipleSelection=e},searchData:function(e){var t=this;this.tableBoxLoading=!0,"search"===e&&(this.currentPage=1),this.searchParam.pageSize=this.pageSize,this.searchParam.pageNo=this.currentPage,this.date?(this.searchParam.startDate=this.formatDate(this.date[0]),this.searchParam.endDate=this.formatDate(this.date[1])):(this.searchParam.startDate="",this.searchParam.endDate=""),this.$http.get(this.netAPI.findAccessRecord,{params:this.searchParam}).then(function(e){200==e.body.status&&(e.body.data.forEach(function(e){e.recordDate=t.parsedate(e.recordDate)}),t.tableData=e.body.data,t.total=e.body.total,t.tableBoxLoading=!1,t.$refs.accessTable.clearSelection())})},formatDate:function(e){var t=e.getFullYear(),a=e.getMonth()+1;a=a<10?"0"+a:a;var s=e.getDate();return t+"-"+a+"-"+(s=s<10?"0"+s:s)},parsedate:function(e){return e.slice(0,10)+" "+e.slice(11,19)},findDevice:function(){var e=this,t=[1,3].map(function(t){return e.$http.get(e.deviceAPI.find,{params:{type:t,pageNo:1,pageSize:1e5}})});o.a.all(t).then(function(t){var a=t.map(function(e){return e.body.data}),s=a[0].concat(a[1]);e.deviceType=s})},findAccessResult:function(){var e=this;this.$http.get(this.netAPI.findAccessResult).then(function(t){200==t.body.status&&(e.AccessResultType=t.body.data)})},getPersonType:function(){var e=this;this.$http.get(this.peopleAPI.findPeopleCategory).then(function(t){e.personType=t.body.data})},findAccessCategory:function(){var e=this;this.$http.get(this.netAPI.findAccessCategory).then(function(t){200==t.body.status&&(e.divergenceType=t.body.data)})},openDetail:function(e){var t=this;console.log(i()(e)),this.persondetail.name=e.name,this.persondetail.code=e.code,this.persondetail.personType=e.personType,this.persondetail.passageWay=e.passageWay,this.persondetail.validateResult=e.validateResult,this.persondetail.divergenceType=e.divergenceType,this.persondetail.recordDate=e.recordDate,this.persondetail.deviceName=e.deviceName,this.snapPhoto=e.snapPhoto,this.persondetail.snapPhoto=e.snapPhoto,this.$http.get(this.netAPI.findPersonDetail,{params:{code:e.code}}).then(function(e){if(200==e.body.status&&e.body.data){var a=e.body.data;t.persondetail.organization=e.body.data.organization,t.persondetail.urls=e.body.data.urls,t.$http.get(t.netAPI.findPersonProperty,{params:{categoryNo:e.body.data.type}}).then(function(e){200==e.body.status?(t.persondetail.idcard=a.code,t.persondetail.phone=a.ext_01):t.$message.warning("查询属性失败"+e.body.message),t.accessrecordsdialogVisible=!0},function(e){t.$message.warning("服务错误"+e),t.accessrecordsdialogVisible=!0})}t.accessrecordsdialogVisible=!0},function(e){t.$message.warning("服务错误"+e),t.accessrecordsdialogVisible=!0})},handlecloseaccessrecordsdialogVisible:function(e){e()},cancelaccessrecordsdialogVisible:function(){this.accessrecordsdialogVisible=!1},deleteRow:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=[];if(t){if("[object Array]"==Object.prototype.toString.call(t))for(var s in t)a.push({id:t[s].id});else a.push({id:t.id});console.log(i()(a)),this.$confirm(this.$t("delete.deleteRow"),this.$t("delete.prompt"),{distinguishCancelAndClose:!0,type:"warning",confirmButtonText:this.$t("common.delete"),cancelButtonText:this.$t("delete.cancel")}).then(function(){e.$http.post(e.netAPI.delete,a).then(function(t){200==t.data.status&&(a.length==e.tableData.length?e.searchData(e.pageSize,e.currentPage-1>0?e.currentPage-1:1):e.searchData(e.pageSize,e.currentPage))})}).catch(function(){e.$message({type:"info",message:e.$t("delete.canceledDeletion")})})}else this.$message({message:this.$t("delete.choose"),type:"warning"})},handleSizeChange:function(e){this.pageSize=e,this.searchData()},handleCurrentChange:function(e){this.currentPage=e,this.searchData()},detailsDialogClose:function(){this.detailsDialog=!1}}},h={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"accessRecord-Page"},[a("separator",{attrs:{id:"bread"}}),e._v(" "),a("div",{staticClass:"accessRecord-content"},[a("div",{staticClass:"operation-box"},[a("i",{staticClass:"blue"}),e._v(" "),a("div",{staticClass:"title"},[a("span",[e._v(e._s(e.$t("accessRecords.identification")))])]),e._v(" "),a("div",{staticClass:"search"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.searchParam}},[a("el-form-item",{attrs:{label:e.$t("accessRecords.nameOrNum")+"："}},[a("el-input",{staticStyle:{width:"3.5rem"},attrs:{placeholder:e.$t("accessRecords.nameOrNum")},model:{value:e.searchParam.field,callback:function(t){e.$set(e.searchParam,"field",t)},expression:"searchParam.field"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("accessRecords.time")+"："}},[a("el-date-picker",{staticClass:"picker",staticStyle:{width:"6.5rem"},attrs:{type:"daterange","range-separator":e.$t("common.to"),"start-placeholder":e.$t("common.startDate"),"end-placeholder":e.$t("common.endDate")},on:{change:function(t){e.changeDate()}},model:{value:e.date,callback:function(t){e.date=t},expression:"date"}})],1),e._v(" "),a("el-form-item",{staticClass:"person-type",attrs:{label:e.$t("accessRecords.personnelType")+"："}},[a("el-select",{staticClass:"mini-input",staticStyle:{width:"3.5rem"},attrs:{placeholder:e.$t("accessRecords.all"),clearable:"",filterable:""},model:{value:e.searchParam.personType,callback:function(t){e.$set(e.searchParam,"personType",t)},expression:"searchParam.personType"}},e._l(e.personType,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.no}})}))],1),e._v(" "),a("el-form-item",{staticClass:"device",attrs:{label:e.$t("accessRecords.equipment")+"："}},[a("el-select",{staticClass:"mini-input",staticStyle:{width:"3rem"},attrs:{placeholder:e.$t("accessRecords.all"),clearable:"",filterable:""},model:{value:e.searchParam.sn,callback:function(t){e.$set(e.searchParam,"sn",t)},expression:"searchParam.sn"}},e._l(e.deviceType,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),a("el-form-item",{staticClass:"search-button"},[a("el-button",{staticClass:"search-button",attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){e.searchData("search")}}},[e._v(e._s(e.$t("common.search")))])],1),e._v(" "),a("el-form-item",[a("el-button",{ref:"batchremove",staticClass:"remove-button",attrs:{icon:"el-icon-delete",disabled:e.batchdisabled},on:{click:function(t){e.deleteRow(e.multipleSelection)}}},[e._v(e._s(e.$t("common.batchDeletion"))+"\n              ")])],1)],1)],1)]),e._v(" "),a("div",{ref:"tableBox",staticClass:"table-box"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableBoxLoading,expression:"tableBoxLoading"}],ref:"accessTable",attrs:{data:e.tableData,height:"575","header-cell-style":{background:"rgba(245,248,252,1)"},"default-sort":{prop:"id",order:"ascending"},"row-key":e.getRowKeys},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{fixed:"",type:"selection",width:"55","reserve-selection":""}}),e._v(" "),a("el-table-column",{attrs:{label:e.$t("accessRecords.number"),type:"index",width:"80",align:"center"}}),e._v(" "),e._l(e.tableDataLabel,function(t,s){return a("el-table-column",{key:s,attrs:{label:"en"==e.$i18n.locale?t.enName:t.name,prop:t.property,"min-width":t.width,align:"center",formatter:2==s?e.filterTbale:6==s?e.filterTbale2:null}})}),e._v(" "),a("el-table-column",{attrs:{label:e.$t("accessRecords.snapPhotos"),prop:"snapPhoto",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[void 0!==t.row.snapPhoto?a("div",[a("img",{staticStyle:{width:"100%",height:"100%"},attrs:{src:t.row.snapPhoto,alt:"not found"}})]):a("div",["en"==e.$i18n.locale?a("span",[e._v("No photos")]):a("span",[e._v("暂无抓拍照片")])])]}}])}),e._v(" "),a("el-table-column",{attrs:{fixed:"right",label:e.$t("common.operation"),width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticStyle:{color:"#f56c6c"},attrs:{type:"text",size:"small"},on:{click:function(a){e.openDetail(t.row)}}},[e._v("\n                    "+e._s(e.$t("common.details"))+"\n                    ")]),e._v(" "),a("el-button",{staticClass:"del-btn",attrs:{type:"text",size:"small"},nativeOn:{click:function(a){a.preventDefault(),e.deleteRow(t.row)}}},[e._v("\n                      "+e._s(e.$t("common.delete"))+"\n                    ")])]}}])})],2),e._v(" "),a("div",{ref:"pagination",staticClass:"pagination-box"},[a("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[5,10,20],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:pageSize":function(t){e.pageSize=t}}})],1)],1),e._v(" "),a("el-dialog",{staticClass:"access-dialog",attrs:{title:e.$t("accessRecords.detailsAlert.title"),visible:e.accessrecordsdialogVisible,width:"646px","before-close":e.handlecloseaccessrecordsdialogVisible},on:{"update:visible":function(t){e.accessrecordsdialogVisible=t}}},[a("div",{staticClass:"pic-div"},[a("div",{staticClass:"pic-box"},[a("img",{staticStyle:{width:"100%",height:"100%"},attrs:{src:e.persondetail.snapPhoto,alt:e.$t("accessRecords.detailsAlert.noPhotos")}})]),e._v(" "),a("div",{staticClass:"pic-info"},[e.persondetail.urls&&e.persondetail.snapPhoto?a("span",[e._v("87%")]):a("span",[e._v(e._s(e.$t("accessRecords.detailsAlert.noResult")))])]),e._v(" "),a("div",{staticClass:"pic-box"},[a("img",{staticStyle:{width:"100%",height:"100%"},attrs:{src:e.persondetail.urls,alt:e.$t("accessRecords.detailsAlert.noPhotos")}})])]),e._v(" "),a("div",{staticClass:"detailcontent"},[a("div",e._l(e.detailArr1,function(t,s){return a("div",{key:s},[a("span",{staticClass:"detail-title"},[e._v(e._s(t.name)+"：")]),e._v(" "),e.persondetail[t.property]?a("span",{staticClass:"detail-info"},[e._v("\n                "+e._s(e.persondetail[t.property])+"\n               ")]):a("span",{staticClass:"detail-info"},[e._v(e._s(e.$t("accessRecords.detailsAlert.null")))])])})),e._v(" "),a("div",e._l(e.detailArr2,function(t,s){return a("div",{key:s},[a("span",{staticClass:"detail-title"},[e._v(e._s(t.name)+"：")]),e._v(" "),e.persondetail[t.property]?a("span",{staticClass:"detail-info"},[e._v("\n                "+e._s(e.persondetail[t.property])+"\n               ")]):a("span",{staticClass:"detail-info"},[e._v(e._s(e.$t("accessRecords.detailsAlert.null")))])])}))]),e._v(" "),a("div",{staticClass:"sub"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.cancelaccessrecordsdialogVisible("selectgroupform")}}},[e._v(e._s(e.$t("common.ok")))])],1)])],1)],1)},staticRenderFns:[]};var u=a("VU/8")(p,h,!1,function(e){a("12We"),a("ltlz")},"data-v-1a98f121",null);t.default=u.exports}});
//# sourceMappingURL=20.9203b00c0595d84299f0.js.map