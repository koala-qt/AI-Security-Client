{"version":3,"sources":["webpack:///./src/components/pages/project/cp/functional_module/monitoring_system/img/deviceManage/qk.png","webpack:///./src/components/pages/project/cp/functional_module/monitoring_system/img/deviceManage/cam.png","webpack:///src/components/pages/project/cp/functional_module/monitoring_system/add_event_manage.vue","webpack:///./src/components/pages/project/cp/functional_module/monitoring_system/add_event_manage.vue?30d2","webpack:///./src/components/pages/project/cp/functional_module/monitoring_system/add_event_manage.vue"],"names":["module","exports","add_event_manage","data","monitorApi","form","eventName","description","importantEvent","alarmEvent","eventStatus","effTime","rules","formRules","required","message","trigger","name","title","dialogVisible","eventApi","eventform","deviceId","bounds","base64","diviceOptions","deviceLoading","context","areas","lineToPois","canvasSize","listenRectPoi","isInCircle","boundPic","dialogRules","methods","confirm","formName","_this","this","$refs","validate","valid","selfForm","JSON","parse","stringify_default","startTime","finishTime","$route","query","id","$http","post","modify","then","res","console","log","insert","diviceChange","_this2","self","forEach","item","deviceName","groupName","clearHb","initCanvas","get","getImg","params","yImg","Image","setAttribute","onload","bg","createPattern","fillStyle","fillRect","src","resetForm","resetFields","s","clearRect","w","h","canvas","document","getElementById","width","clientWidth","height","clientHeight","getContext","strokeStyle","addEventListener","doClickCanvas","doMousemove","e","length","fill","layerX","x","layerY","y","strokeCircle","autoClose","ar","push","drawLine","_this3","index","beginPath","moveTo","lineTo","stroke","arc","Math","PI","handleClose","done","showDialog","remoteMethod","queryDivice","_this4","deviceManage","findGroup","body","status","changeBase","toDataURL","addRule","_this5","wstr","str","g","dex","toFixed","eventId","newEventForm","delRule","hasOwnProperty","ruleIds","splice","editRule","rule","watch","val","handler","newVal","oldVal","deep","created","_this6","Object","api","detail","newform","monitoring_system_add_event_manage","render","_vm","_h","$createElement","_c","_self","staticClass","_v","ref","attrs","model","label-width","label","prop","staticStyle","value","callback","$$v","$set","expression","clearable","key","type","resize","rows","placeholder","format","value-format","range-separator","start-placeholder","end-placeholder","_l","span","_s","on","click","$event","visible","before-close","update:visible","filterable","remote","reserve-keyword","remote-method","loading","change","_e","__webpack_require__","slot","staticRenderFns","Component","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"cloud/js/11.a99b8a679bffe8b952a5.js","sourcesContent":["module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAABHNCSVQICAgIfAhkiAAAAa1JREFUOI2t1LFu01AUBuD/v5ckAok+AYgORagKMNChCwMvwFiJvkHFUAmhMFiOdOV7vYLUqRn6AnkCBkYGBiSGklA1CIm5WUHIN76HJY5sNa1twZn820ffPfKRTdSUtfY+yT0AdwGcxHH8+br+G3UggMFisTgAoLTWRwD+GQzGmAAgWGtVXXNtQ9v67yDLIU3TJyGEjUoDeSgiR8v4CsC78nOt9SSKootLYJqmj0XkjYh8bznUjtb6dRRF50BpKSGEOySPh8Phxzaac24vz/MtAFUwz/MPWuvIWvsWwO8mGMmOiPzodrsv1zYkSfLCOfe0xXT71tpn5XuVLSul+r1e70tTkOQEwKMrQRG5PRgMfjUFvfdnALavBAGEphgAGGMykrfWguPxWAP40wZcVuXzXYGz2Wyb5Lcij0ajTpIkuw3An865e5dAEemTPC3yfD7vK6U267QQwkREVospv8MH3vtp+QCl1ClqSms9RWnTZbBjjMmKQHIry7KzOtB7PyXZXwdWNhxC4PI/eG0ZYzIRubkapLhwzr0XkU9FFpGHJL/WgQBA8nkcxzsA8BcXbp0aIyvkWAAAAABJRU5ErkJggg==\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/pages/project/cp/functional_module/monitoring_system/img/deviceManage/qk.png\n// module id = lJUU\n// module chunks = 11","module.exports = \"data:image/png;base64,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\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/pages/project/cp/functional_module/monitoring_system/img/deviceManage/cam.png\n// module id = vK6h\n// module chunks = 11","<template>\r\n  <div class=\"add-event-manage\">\r\n    <div class=\"title\">新建自定义事件</div>\r\n    <!-- <div>{{form}}</div> -->\r\n    <!-- <div>{{form}}</div>\r\n    <div>{{areas}}</div> -->\r\n    <!-- {{form.effTime}} -->\r\n    <div class=\"record-content\">\r\n       <el-form ref=\"form\" :model=\"form\" :rules=\"formRules\" label-width=\"210px\">\r\n        <el-form-item label=\"事件名称:\" prop=\"eventName\">\r\n          <el-input v-model=\"form.eventName\" style=\"width: 260px\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"是否重大事件:\" prop=\"importantEvent\">\r\n          <!-- <el-input v-model=\"form.importantEvent\" style=\"width: 260px\"></el-input> -->\r\n          <el-select\r\n            v-model=\"form.importantEvent\"\r\n            class=\"sel\"\r\n            clearable\r\n          >\r\n            <el-option\r\n              :key=\"0\"\r\n              label=\"是\"\r\n              :value='1'\r\n            >\r\n            </el-option>\r\n            <el-option\r\n              :key=\"1\"\r\n              label=\"否\"\r\n              :value='0'\r\n            >\r\n            </el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item label=\"是否告警事件:\" prop=\"alarmEvent\">\r\n          <!-- <el-input v-model=\"form.alarmEvent\" style=\"width: 260px\"></el-input> -->\r\n          <el-select\r\n            v-model=\"form.alarmEvent\"\r\n            class=\"sel\"\r\n            clearable\r\n          >\r\n            <el-option\r\n              :key=\"0\"\r\n              label=\"是\"\r\n              :value='1'\r\n            >\r\n            </el-option>\r\n            <el-option\r\n              :key=\"1\"\r\n              label=\"否\"\r\n              :value='0'\r\n            >\r\n            </el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item label=\"事件状态:\" prop=\"eventStatus\">\r\n          <!-- <el-input v-model=\"form.eventStatus\" style=\"width: 260px\"></el-input> -->\r\n            <el-select\r\n                v-model=\"form.eventStatus\"\r\n                class=\"sel\"\r\n                clearable\r\n              >\r\n                <el-option\r\n                  :key=\"1\"\r\n                  label=\"开启\"\r\n                  :value='1'\r\n                >\r\n                </el-option>\r\n                <el-option\r\n                  :key=\"2\"\r\n                  label=\"关闭\"\r\n                  :value='0'\r\n                >\r\n                </el-option>\r\n            </el-select>\r\n        </el-form-item>\r\n        <el-form-item label=\"事件描述:\" prop=\"description\">\r\n          <el-input type=\"textarea\" resize=\"none\" v-model=\"form.description\" :rows=\"7\" placeholder=\"请输入事件描述\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"生效时间\" prop=\"effTime\">\r\n          <!-- <el-input v-model=\"form.name\"></el-input> -->\r\n            <el-date-picker\r\n              v-model=\"form.effTime\"\r\n              format=\"yyyy-MM-dd HH:mm:ss\"\r\n              value-format=\"yyyy-MM-dd HH:mm:ss\"\r\n              type=\"datetimerange\"\r\n              range-separator=\"至\"\r\n              start-placeholder=\"开始日期\"\r\n              end-placeholder=\"结束日期\">\r\n            </el-date-picker>\r\n        </el-form-item>\r\n        <el-form-item label=\"事件规则设置:\" prop=\"rules\">\r\n            <div class=\"event-add\">\r\n              <el-row >\r\n                <el-col :span=\"8\" class=\"show-add\" v-for=\"(item, index) in form.rules\" :key=\"index\">\r\n                  <div class=\"show-img\">\r\n                    <img :src=\"item.base64\">\r\n                  </div>\r\n                  <div class=\"show-tro\">\r\n                    <div>设备:{{item.deviceName}}</div>\r\n                    <div>区域名:{{ item.name }}</div>\r\n                    <div class=\"fix\">\r\n                      <i class=\"el-icon-edit\"  @click=\"editRule(index)\"></i>\r\n                      <i class=\"el-icon-delete\" @click=\"delRule(index)\"></i>\r\n                    </div>\r\n                  </div>\r\n                </el-col>\r\n                <el-col :span=\"8\" class=\"show-add\">\r\n                  <div class=\"img-add\">\r\n                    <i class=\"el-icon-circle-plus-outline\" @click=\"showDialog\"></i>\r\n                    <div class=\"tro\">新增事件规则</div>\r\n                  </div>\r\n                   <!-- <div class=\"show-img\">\r\n                    <img src=\"http://img.bimg.126.net/photo/ZZ5EGyuUCp9hBPk6_s4Ehg==/5727171351132208489.jpg\">\r\n                  </div>\r\n                  <div class=\"show-tro\">\r\n                    <div>设备</div>\r\n                    <div>区域名</div>\r\n                    <div class=\"fix\">\r\n                      <i class=\"el-icon-edit\"></i>\r\n                      <i class=\"el-icon-delete\"></i>\r\n                    </div>\r\n                  </div> -->\r\n                </el-col>\r\n              </el-row>\r\n              <!-- <div class=\"img-add\">\r\n               \r\n              </div> -->\r\n            </div>\r\n        </el-form-item>\r\n        <el-form-item>\r\n          <el-button type=\"primary\" @click=\"confirm('form')\">确定</el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n    </div>\r\n   \r\n    <el-dialog\r\n      :title=\"title\"\r\n      :visible.sync=\"dialogVisible\"\r\n      width=\"800px\"\r\n      :before-close=\"handleClose\">\r\n      <!-- <div>{{eventform}}</div> -->\r\n      <el-form ref=\"eventForm\"  :rules=\"dialogRules\" :model=\"eventform\" label-width=\"100px\" class=\"event-form\">\r\n        <el-form-item label=\"设备:\" prop=\"deviceId\">\r\n          <div v-if=\"eventform.id\">{{eventform.deviceName}}</div>\r\n          <el-select\r\n            v-else\r\n            v-model=\"eventform.deviceId\"\r\n            filterable\r\n            remote\r\n            reserve-keyword\r\n            placeholder=\"请搜索关键词\"\r\n            @change=\"diviceChange($event)\"\r\n            :remote-method=\"remoteMethod\"\r\n            :loading=\"deviceLoading\">\r\n            <el-option\r\n              v-for=\"item in diviceOptions\"\r\n              :key=\"item.id\"\r\n              :label=\"item.groupName\"\r\n              :value=\"item.id\">\r\n            </el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item label=\"区域名称:\" prop=\"name\">\r\n           <el-input v-model=\"eventform.name\" style=\"width: 260px\" placeholder=\"请输入区域名称\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"监控画面:\" prop=\"bounds\">\r\n            <!-- <button @click=\"clearHb\">清空</button> -->\r\n            <div class=\"draw-box\" ref=\"drawBox\">\r\n              <canvas id=\"canvas\" ref=\"canvas\" class=\"canvas\">\r\n              </canvas>\r\n              <img  v-if=\"eventform.base64 !== ''\" class=\"latu\" :src=\"eventform.base64\">\r\n              <img   v-if=\"eventform.base64 === ''\" class=\"mr\" src=\"./img/deviceManage/cam.png\" @click=\"clearHb\">\r\n              <div class=\"fix\">\r\n                <img src=\"./img/deviceManage/qk.png\" @click=\"clearHb('notClearPic')\">\r\n              </div>\r\n            </div>\r\n        </el-form-item>\r\n      </el-form>\r\n      <span slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"dialogVisible = false\">取 消</el-button>\r\n        <el-button type=\"primary\" @click=\"addRule('eventForm')\">确 定</el-button>\r\n        \r\n      </span>\r\n    </el-dialog>\r\n   \r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport APICONFIG from '../../../../../../config/api.js';\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      monitorApi: '',\r\n      form: {\r\n        eventName: '',\r\n        description: '',\r\n        importantEvent: 1,\r\n        alarmEvent: 1,\r\n        eventStatus: 1,\r\n        effTime: [], // 生效时间\r\n        rules: [] // 事件规则\r\n      },\r\n      formRules: {\r\n        eventName: [\r\n          { required: true, message: '事件名称不能为空', trigger: 'blur' }\r\n        ],\r\n        effTime: [\r\n           { required: true, message: '生效时间不能为空', trigger: 'blur' }\r\n        ],\r\n        rules: [\r\n          { required: true, message: '事件规则不能为空', trigger: 'blur' }\r\n        ],\r\n        description: [\r\n          { required: true, message: '事件描述不能为空', trigger: 'blur' }\r\n        ],\r\n        importantEvent: [\r\n          { required: true, message: '重大事件不能为空', trigger: 'blur' }\r\n        ],\r\n        alarmEvent: [\r\n          { required: true, message: '告警事件不能为空', trigger: 'blur' }\r\n        ],\r\n        eventStatus: [\r\n          { required: true, message: '事件状态不能为空', trigger: 'blur' }\r\n        ]\r\n      },\r\n      name: '新增自定义事件',\r\n      title: '新增事件规则',\r\n      dialogVisible: false,\r\n      // 弹窗警戒区\r\n      eventApi: '',\r\n      eventform: {\r\n        deviceId: '',\r\n        name: '',\r\n        bounds: '',\r\n        base64: ''\r\n      },\r\n      diviceOptions: [],\r\n      deviceLoading: false,\r\n      context: '',\r\n      areas: [], // 警戒区域\r\n      lineToPois: [],\r\n      canvasSize: {},\r\n      // isAutoClose: false,\r\n      listenRectPoi: [],\r\n      isInCircle: false,\r\n      boundPic: '', // 警戒区域图片\r\n      dialogRules: {\r\n        name: [\r\n          { required: true, message: '活动名称不能为空', trigger: 'blur' }\r\n        ],\r\n        deviceId: [\r\n          { required: true, message: '设备选项不能为空', trigger: 'blur' }\r\n        ]\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    confirm(formName) {\r\n      this.$refs[formName].validate((valid) => {\r\n        if (valid) {\r\n          let selfForm = JSON.parse(JSON.stringify(this.form))\r\n          selfForm.startTime = selfForm.effTime[0]\r\n          selfForm.finishTime = selfForm.effTime[1]\r\n          delete selfForm.effTime\r\n          // 编辑状态\r\n          if(this.$route.query.id) {\r\n            selfForm.id = this.$route.query.id\r\n            this.$http.post(this.eventApi.modify, selfForm).then(res => {\r\n              // this.$router.go(-1)\r\n              // this.resetForm('form')\r\n            })\r\n          } else {\r\n            console.log(selfForm)\r\n            this.$http.post(this.eventApi.insert, selfForm).then(res => {\r\n              // this.$router.go(-1)\r\n              // this.resetForm('form')\r\n            })\r\n          }\r\n        }\r\n      })\r\n    },\r\n\r\n    diviceChange(deviceId) {\r\n      let self = this\r\n      console.log(this.diviceOptions)\r\n       // 取deviceName\r\n      this.diviceOptions.forEach(item => {\r\n        if(item.id === deviceId) {\r\n          this.eventform.deviceName = item.groupName\r\n        }\r\n      })\r\n      this.clearHb()\r\n      this.initCanvas()\r\n\r\n      this.$http.get(this.eventApi.getImg, {\r\n        params: {\r\n          deviceId: 9\r\n        }\r\n      }).then(res => {\r\n        let yImg = new Image();\r\n        yImg.setAttribute('crossorigin', 'anonymous');\r\n        yImg.onload = function() {\r\n          let bg = self.context.createPattern(this, 'repeat');\r\n          self.context.fillStyle = bg;\r\n          self.context.fillRect(0, 0, 660, 380);\r\n        };\r\n        // yImg.src = 'static/img/workbench/demo.jpg';\r\n        console.log(res.data.data)\r\n        yImg.src = `http://${res.data.data}`\r\n        this.eventform.base64 = 'http://192.168.2.240:32377/api/v1/get_picture'\r\n      })\r\n    },\r\n    /* 新增 */\r\n    resetForm(formName) {\r\n      console.log(formName)\r\n      this.$refs[formName].resetFields();\r\n    },\r\n    // 清除画布\r\n    clearHb(s) {\r\n      if(this.context) {\r\n        this.context.clearRect(0, 0, this.canvasSize.w, this.canvasSize.h);\r\n      }\r\n      this.lineToPois = []\r\n      this.diviceOptions = []\r\n      this.listenRectPoi = []\r\n      // if(s !== 'notClearPic') {\r\n      //   this.eventform.base64 = ''\r\n      // }\r\n      this.isInCircle = false\r\n      // this.context.clearRect(0, 0, this.canvasSize.w, this.canvasSize.h);\r\n    },\r\n    // 初始化canvas\r\n    initCanvas() {\r\n      let canvas = document.getElementById(\"canvas\");\r\n      canvas.width = this.$refs.canvas.clientWidth;\r\n      canvas.height = this.$refs.canvas.clientHeight;\r\n      this.canvasSize = {\r\n        w: canvas.width,\r\n        h: canvas.height\r\n      }\r\n      this.context = canvas.getContext(\"2d\");//得到绘图的上下文环境\r\n      this.context.strokeStyle = \"red\";//设置线条颜色\r\n      // 监听canvas点击事件\r\n      canvas.addEventListener(\"click\", this.doClickCanvas, false);\r\n      // 监听canvas鼠标移动事件\r\n      canvas.addEventListener(\"mousemove\", this.doMousemove, false);\r\n    },\r\n    // 鼠标悬浮事件\r\n    doMousemove(e) {\r\n      if(this.listenRectPoi.length > 0) {\r\n        this.context.fillStyle = \"white\";\r\n        this.context.fill();\r\n        this.isInCircle = false;\r\n        if(e.layerX < this.listenRectPoi[2].x &&\r\n           e.layerX > this.listenRectPoi[0].x &&\r\n           e.layerY > this.listenRectPoi[0].y &&\r\n           e.layerY < this.listenRectPoi[1].y && this.lineToPois.length > 0) {\r\n          this.strokeCircle(this.lineToPois[0].x, this.lineToPois[0].y) // 画园\r\n          this.isInCircle = true;\r\n          this.context.fillStyle = \"red\";\r\n          this.context.fill();\r\n        }\r\n      }\r\n    },\r\n    // 点击canvas\r\n    doClickCanvas(e) {\r\n      //清空画布\r\n      if(this.isInCircle) {\r\n        this.autoClose()\r\n      } else {\r\n        if(this.lineToPois.length === 0) {\r\n          let ar = [{\r\n            x: e.layerX - 3,\r\n            y: e.layerY - 3,\r\n          },\r\n          {\r\n            x: e.layerX - 3,\r\n            y: e.layerY + 3,\r\n          },\r\n          {\r\n            x: e.layerX + 3,\r\n            y: e.layerY - 3,\r\n          }]\r\n          this.listenRectPoi = ar\r\n        }\r\n        this.lineToPois.push({\r\n          x: e.layerX,\r\n          y: e.layerY\r\n        })\r\n      // this.isAutoClose = false\r\n        this.drawLine()\r\n      }\r\n    },\r\n    // 闭合线\r\n    autoClose() {\r\n      this.lineToPois.push(this.lineToPois[0])\r\n      // this.isAutoClose = true\r\n      this.drawLine()\r\n      this.areas.push(this.lineToPois)\r\n      this.lineToPois = []\r\n    },\r\n    // 绘制线\r\n    drawLine() {\r\n      // if(this.lineToPois.length === 1) {\r\n      //   this.strokeCircle(this.lineToPois[0].x, this.lineToPois[0].y) // 画园\r\n      // }\r\n      if(this.lineToPois.length > 1) {\r\n        this.lineToPois.forEach((item, index) => {\r\n          if(index === this.lineToPois.length - 2) {\r\n            this.context.beginPath();// 开始绘制线条，若不使用beginPath，则不能绘制多条线条\r\n            this.context.moveTo(item.x, item.y);//线条开始位置\r\n          } else if(index === this.lineToPois.length - 1) {\r\n            this.context.lineTo(item.x, item.y);// 线条经过点\r\n          }\r\n        })\r\n        this.context.stroke();\r\n      }\r\n    },\r\n    // 绘制园\r\n    strokeCircle(x, y) {\r\n      this.context.beginPath();\r\n      this.context.fillStyle = \"red\";\r\n      this.context.arc(x, y, 3, 0, 2 * Math.PI);\r\n      this.context.stroke();\r\n    },\r\n\r\n    handleClose(done) {\r\n      this.resetForm('eventForm')\r\n      this.eventform = {\r\n        deviceId: '',\r\n        name: '',\r\n        bounds: '',\r\n        base64: ''\r\n      }\r\n      done()\r\n    },\r\n    showDialog() {\r\n      this.dialogVisible = true\r\n    },\r\n    // 设备远程搜索\r\n    remoteMethod(query) {\r\n      console.log(query)\r\n      this.queryDivice(query)\r\n    },\r\n    queryDivice(name) {\r\n      let params = {\r\n        groupName: name\r\n      }\r\n      this.deviceLoading = true\r\n      this.$http.get(this.monitorApi.deviceManage.findGroup, {params}).then(res => {\r\n        if (res.body.status == 200) {\r\n          this.deviceLoading = false\r\n          this.diviceOptions = res.body.data\r\n        }\r\n      })\r\n    },\r\n    changeBase() {\r\n      let ctx = document.getElementById('canvas');\r\n      let dataURL = ctx.toDataURL(\"image/png\", 1.0);\r\n      return dataURL\r\n    },\r\n    addRule(formName) {\r\n      this.$refs[formName].validate((valid) => {\r\n        if (valid) {\r\n          let wstr = ''\r\n          this.areas.forEach(item => {\r\n            let str = ''\r\n            item.forEach((g, dex) => {\r\n              str = str + `${(g['x'] * 1920 / 660).toFixed(2)}/${(g['y'] * 1080 / 380).toFixed(2)}${item.length - 1 === dex ? '' : ','}`\r\n            })\r\n            wstr = `${wstr}${str};`\r\n          })\r\n          console.log(wstr)\r\n          this.eventform.bounds = wstr\r\n          // 编辑的时候加上事件id\r\n          if(this.$route.query.id) {\r\n            this.eventform.eventId = this.$route.query.id\r\n          }\r\n          // base64\r\n          debugger\r\n          this.eventform.base64 = this.changeBase()\r\n          let newEventForm = JSON.parse(JSON.stringify(this.eventform))\r\n          if(this.eventform.id) {\r\n            this.form.rules.forEach((item, dex) => {\r\n              console.log(item)\r\n              if (item.id === this.eventform.id) {\r\n                this.form.rules[dex] = this.eventform\r\n              }\r\n            })\r\n          } else {\r\n            this.form.rules.push(newEventForm)\r\n          }\r\n\r\n          console.log(this.form.rules)\r\n          this.dialogVisible = false\r\n          this.resetForm('eventForm')\r\n        } else {\r\n          return false;\r\n        }\r\n      });\r\n    },\r\n    delRule(dex) {\r\n      if(this.form.rules[dex].hasOwnProperty('id')) {\r\n        if(this.form.hasOwnProperty('ruleIds')) {\r\n          this.form.ruleIds.push(this.form.rules[dex].id)\r\n        } else {\r\n          this.form.ruleIds = []\r\n          this.form.ruleIds.push(this.form.rules[dex].id)\r\n        }\r\n      }\r\n      this.form.rules.splice(dex, 1)\r\n    },\r\n    editRule(dex) {\r\n      let rule = this.form.rules[dex]\r\n      debugger\r\n      this.dialogVisible = true\r\n      this.eventform = JSON.parse(JSON.stringify(rule))\r\n      this.title = `${rule.deviceName}事件规则`\r\n    }\r\n  },\r\n  watch: {\r\n    dialogVisible(val) {\r\n      this.clearHb()\r\n    },\r\n    'form': {\r\n      handler(newVal, oldVal) {\r\n        // debugger\r\n      },\r\n      deep: true\r\n    }\r\n  },\r\n\r\n  created() {\r\n    this.monitorApi = APICONFIG().get(\"monitorSystem\")\r\n    this.eventApi = APICONFIG().get(\"event_manage\")\r\n    // 编辑状态给form表单赋值\r\n    if(this.$route.query.id) {\r\n      this.$http.get(this.eventApi.detail, {\r\n        params: {\r\n          id: this.$route.query.id\r\n        }\r\n      }).then(res => {\r\n        let newform = JSON.parse(JSON.stringify(res.data.data))\r\n        newform.effTime = [newform.startTime, newform.finishTime]\r\n        console.log(newform)\r\n        this.form = newform\r\n      })\r\n    }\r\n  },\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n  .add-event-manage {\r\n    position: absolute;\r\n    top: 0;\r\n    left: 30px;\r\n    right: 30px;\r\n    margin-bottom: 10px;\r\n    background: #fff;\r\n    min-height: 98%;\r\n    .title {\r\n      background: #F5F8FC;\r\n      height: 80px;\r\n      line-height: 80px;\r\n      font-size: 20px;\r\n      box-sizing: border-box;\r\n      display: flex;\r\n      align-items: center;\r\n    }\r\n    .event-add {\r\n      .show-add {\r\n        float: left;\r\n        margin-bottom: 15px;\r\n        padding: 5px;\r\n        // box-shadow:0px 1px 4px rgba(196,196,196,0.46);\r\n        width: 260px;\r\n        height: 296px;\r\n        background-color: #fff;\r\n        .show-img {\r\n          height: 210px;\r\n          img {\r\n            width: 100%;\r\n            height: 210px;\r\n          }\r\n        }\r\n        .show-tro {\r\n          height: 87px;\r\n          background-color: #fff;\r\n          padding-left: 8px;\r\n          box-shadow:0px 1px 4px rgba(196,196,196,0.46);\r\n          .fix {\r\n            text-align: right;\r\n            margin-right: 12px;\r\n            i {\r\n              font-size: 18px;\r\n              cursor: pointer;\r\n            }\r\n            .el-icon-edit {\r\n              margin-right: 5px;\r\n            }\r\n          }\r\n          div {\r\n            height: 28px;\r\n            line-height: 28px;\r\n          }\r\n        }\r\n\r\n        .img-add {\r\n          width: 100%;\r\n          height: 296px;\r\n          text-align: center;\r\n          background: #f1f1f1;\r\n          i {\r\n            cursor: pointer;\r\n            color: #707070;\r\n            margin-top: 108px;\r\n            font-size: 34px;\r\n          }\r\n          .tro {\r\n            line-height: 4px;\r\n          }\r\n        } \r\n      }\r\n      \r\n    }\r\n    .record-content {\r\n      padding: 60px 30px 0 30px;\r\n      max-width: 1000px;\r\n    }\r\n    .event-form {\r\n      .draw-box {\r\n        position: relative;\r\n        display: flex;\r\n        justify-content: center;\r\n        width: 660px;\r\n        height: 440px;\r\n        .latu {\r\n          position: absolute;\r\n          z-index: 1;\r\n          top: 0;\r\n          height: 380px;\r\n          width: 100%;\r\n        }\r\n        .mr {\r\n          margin-top: 154px;\r\n          width: 63px;\r\n          height: 47px;\r\n        }\r\n        canvas {\r\n          position: absolute;\r\n          border:1px solid rgba(220,223,230,1);\r\n          z-index: 100;\r\n          height: 380px;\r\n          width: 100%;\r\n          top: 0;\r\n        }\r\n        .fix {\r\n          position: absolute;\r\n          display: flex;\r\n          justify-content: center;\r\n          align-items: center;\r\n          height: 60px;\r\n          line-height: 60px;\r\n          bottom: 0;\r\n          width: 100%;\r\n          box-shadow:0px 3px 6px rgba(0,0,0,0.16);\r\n          img {\r\n            cursor: pointer;\r\n            width: 20px;\r\n            height: 20px;\r\n          }\r\n        }\r\n      }\r\n      .fix {\r\n        text-align: center;\r\n      }\r\n    }\r\n    \r\n    \r\n  }\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/components/pages/project/cp/functional_module/monitoring_system/add_event_manage.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"add-event-manage\"},[_c('div',{staticClass:\"title\"},[_vm._v(\"新建自定义事件\")]),_vm._v(\" \"),_c('div',{staticClass:\"record-content\"},[_c('el-form',{ref:\"form\",attrs:{\"model\":_vm.form,\"rules\":_vm.formRules,\"label-width\":\"210px\"}},[_c('el-form-item',{attrs:{\"label\":\"事件名称:\",\"prop\":\"eventName\"}},[_c('el-input',{staticStyle:{\"width\":\"260px\"},model:{value:(_vm.form.eventName),callback:function ($$v) {_vm.$set(_vm.form, \"eventName\", $$v)},expression:\"form.eventName\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"是否重大事件:\",\"prop\":\"importantEvent\"}},[_c('el-select',{staticClass:\"sel\",attrs:{\"clearable\":\"\"},model:{value:(_vm.form.importantEvent),callback:function ($$v) {_vm.$set(_vm.form, \"importantEvent\", $$v)},expression:\"form.importantEvent\"}},[_c('el-option',{key:0,attrs:{\"label\":\"是\",\"value\":1}}),_vm._v(\" \"),_c('el-option',{key:1,attrs:{\"label\":\"否\",\"value\":0}})],1)],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"是否告警事件:\",\"prop\":\"alarmEvent\"}},[_c('el-select',{staticClass:\"sel\",attrs:{\"clearable\":\"\"},model:{value:(_vm.form.alarmEvent),callback:function ($$v) {_vm.$set(_vm.form, \"alarmEvent\", $$v)},expression:\"form.alarmEvent\"}},[_c('el-option',{key:0,attrs:{\"label\":\"是\",\"value\":1}}),_vm._v(\" \"),_c('el-option',{key:1,attrs:{\"label\":\"否\",\"value\":0}})],1)],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"事件状态:\",\"prop\":\"eventStatus\"}},[_c('el-select',{staticClass:\"sel\",attrs:{\"clearable\":\"\"},model:{value:(_vm.form.eventStatus),callback:function ($$v) {_vm.$set(_vm.form, \"eventStatus\", $$v)},expression:\"form.eventStatus\"}},[_c('el-option',{key:1,attrs:{\"label\":\"开启\",\"value\":1}}),_vm._v(\" \"),_c('el-option',{key:2,attrs:{\"label\":\"关闭\",\"value\":0}})],1)],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"事件描述:\",\"prop\":\"description\"}},[_c('el-input',{attrs:{\"type\":\"textarea\",\"resize\":\"none\",\"rows\":7,\"placeholder\":\"请输入事件描述\"},model:{value:(_vm.form.description),callback:function ($$v) {_vm.$set(_vm.form, \"description\", $$v)},expression:\"form.description\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"生效时间\",\"prop\":\"effTime\"}},[_c('el-date-picker',{attrs:{\"format\":\"yyyy-MM-dd HH:mm:ss\",\"value-format\":\"yyyy-MM-dd HH:mm:ss\",\"type\":\"datetimerange\",\"range-separator\":\"至\",\"start-placeholder\":\"开始日期\",\"end-placeholder\":\"结束日期\"},model:{value:(_vm.form.effTime),callback:function ($$v) {_vm.$set(_vm.form, \"effTime\", $$v)},expression:\"form.effTime\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"事件规则设置:\",\"prop\":\"rules\"}},[_c('div',{staticClass:\"event-add\"},[_c('el-row',[_vm._l((_vm.form.rules),function(item,index){return _c('el-col',{key:index,staticClass:\"show-add\",attrs:{\"span\":8}},[_c('div',{staticClass:\"show-img\"},[_c('img',{attrs:{\"src\":item.base64}})]),_vm._v(\" \"),_c('div',{staticClass:\"show-tro\"},[_c('div',[_vm._v(\"设备:\"+_vm._s(item.deviceName))]),_vm._v(\" \"),_c('div',[_vm._v(\"区域名:\"+_vm._s(item.name))]),_vm._v(\" \"),_c('div',{staticClass:\"fix\"},[_c('i',{staticClass:\"el-icon-edit\",on:{\"click\":function($event){_vm.editRule(index)}}}),_vm._v(\" \"),_c('i',{staticClass:\"el-icon-delete\",on:{\"click\":function($event){_vm.delRule(index)}}})])])])}),_vm._v(\" \"),_c('el-col',{staticClass:\"show-add\",attrs:{\"span\":8}},[_c('div',{staticClass:\"img-add\"},[_c('i',{staticClass:\"el-icon-circle-plus-outline\",on:{\"click\":_vm.showDialog}}),_vm._v(\" \"),_c('div',{staticClass:\"tro\"},[_vm._v(\"新增事件规则\")])])])],2)],1)]),_vm._v(\" \"),_c('el-form-item',[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){_vm.confirm('form')}}},[_vm._v(\"确定\")])],1)],1)],1),_vm._v(\" \"),_c('el-dialog',{attrs:{\"title\":_vm.title,\"visible\":_vm.dialogVisible,\"width\":\"800px\",\"before-close\":_vm.handleClose},on:{\"update:visible\":function($event){_vm.dialogVisible=$event}}},[_c('el-form',{ref:\"eventForm\",staticClass:\"event-form\",attrs:{\"rules\":_vm.dialogRules,\"model\":_vm.eventform,\"label-width\":\"100px\"}},[_c('el-form-item',{attrs:{\"label\":\"设备:\",\"prop\":\"deviceId\"}},[(_vm.eventform.id)?_c('div',[_vm._v(_vm._s(_vm.eventform.deviceName))]):_c('el-select',{attrs:{\"filterable\":\"\",\"remote\":\"\",\"reserve-keyword\":\"\",\"placeholder\":\"请搜索关键词\",\"remote-method\":_vm.remoteMethod,\"loading\":_vm.deviceLoading},on:{\"change\":function($event){_vm.diviceChange($event)}},model:{value:(_vm.eventform.deviceId),callback:function ($$v) {_vm.$set(_vm.eventform, \"deviceId\", $$v)},expression:\"eventform.deviceId\"}},_vm._l((_vm.diviceOptions),function(item){return _c('el-option',{key:item.id,attrs:{\"label\":item.groupName,\"value\":item.id}})}))],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"区域名称:\",\"prop\":\"name\"}},[_c('el-input',{staticStyle:{\"width\":\"260px\"},attrs:{\"placeholder\":\"请输入区域名称\"},model:{value:(_vm.eventform.name),callback:function ($$v) {_vm.$set(_vm.eventform, \"name\", $$v)},expression:\"eventform.name\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"监控画面:\",\"prop\":\"bounds\"}},[_c('div',{ref:\"drawBox\",staticClass:\"draw-box\"},[_c('canvas',{ref:\"canvas\",staticClass:\"canvas\",attrs:{\"id\":\"canvas\"}}),_vm._v(\" \"),(_vm.eventform.base64 !== '')?_c('img',{staticClass:\"latu\",attrs:{\"src\":_vm.eventform.base64}}):_vm._e(),_vm._v(\" \"),(_vm.eventform.base64 === '')?_c('img',{staticClass:\"mr\",attrs:{\"src\":require(\"./img/deviceManage/cam.png\")},on:{\"click\":_vm.clearHb}}):_vm._e(),_vm._v(\" \"),_c('div',{staticClass:\"fix\"},[_c('img',{attrs:{\"src\":require(\"./img/deviceManage/qk.png\")},on:{\"click\":function($event){_vm.clearHb('notClearPic')}}})])])])],1),_vm._v(\" \"),_c('span',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{on:{\"click\":function($event){_vm.dialogVisible = false}}},[_vm._v(\"取 消\")]),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){_vm.addRule('eventForm')}}},[_vm._v(\"确 定\")])],1)],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-395b4ef3\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/pages/project/cp/functional_module/monitoring_system/add_event_manage.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../../../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true,\\\"publicPath\\\":\\\"../../\\\"}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../../../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-395b4ef3\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!../../../../../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./add_event_manage.vue\")\n}\nvar normalizeComponent = require(\"!../../../../../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./add_event_manage.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./add_event_manage.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../../../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-395b4ef3\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../../../../../node_modules/vue-loader/lib/selector?type=template&index=0!./add_event_manage.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/pages/project/cp/functional_module/monitoring_system/add_event_manage.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}