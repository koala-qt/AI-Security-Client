webpackJsonp([16],{DsP8:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s("mvHQ"),a=s.n(i),n=s("//Fk"),c=s.n(n),o=s("OyrO"),l=s("2hMI"),r={data:function(){return{tableData:[],settingIds:[],addList:[],deviceIds:[],dialogTableVisible:!1,settingDialogVisible:!1,settingForm:{inOut:0},getRowKeys:function(e){return e.id},allWeeks:[{name:this.$t("accessSystem.zhouyi"),timeList:[{timeQj:[0,144]}]},{name:this.$t("accessSystem.zhouer"),timeList:[{timeQj:[0,144]}]},{name:this.$t("accessSystem.zhousan"),timeList:[{timeQj:[0,144]}]},{name:this.$t("accessSystem.zhousi"),timeList:[{timeQj:[0,144]}]},{name:this.$t("accessSystem.zhouwu"),timeList:[{timeQj:[0,144]}]},{name:this.$t("accessSystem.zhouliu"),timeList:[{timeQj:[0,144]}]},{name:this.$t("accessSystem.zhouri"),timeList:[{timeQj:[0,144]}]}],mode:"addressList",fromData:[{id:"1",pid:0,label:"一级 1",children:[{id:"1-1",pid:"1",label:"二级 1-1",children:[]}]}],toData:[],deviceAlreadyList:[],netAPI:{},value4:"",value:"",total:0,pageNumber:1,store:this.$store.default.state.accessManage,multipleSelection:[],pageSize:5}},created:function(){this.netAPI=Object(l.a)().get("accessSystem"),this.getDeviceList()},methods:{timeDataTransfer:function(e){var t=this;this.allWeeks=[{name:this.$t("accessSystem.zhouyi"),timeList:[{timeQj:[0,144]}]},{name:this.$t("accessSystem.zhouer"),timeList:[{timeQj:[0,144]}]},{name:this.$t("accessSystem.zhousan"),timeList:[{timeQj:[0,144]}]},{name:this.$t("accessSystem.zhousi"),timeList:[{timeQj:[0,144]}]},{name:this.$t("accessSystem.zhouwu"),timeList:[{timeQj:[0,144]}]},{name:this.$t("accessSystem.zhouliu"),timeList:[{timeQj:[0,144]}]},{name:this.$t("accessSystem.zhouri"),timeList:[{timeQj:[0,144]}]}];var s=["mon","tue","wed","thu","fri","sat","sun"],i=e,a=!0;s.forEach(function(e,t){i[s[t]]||(a=!1)}),a&&this.allWeeks.forEach(function(e,s){t.allWeeks[s].timeList&&(t.allWeeks[s].timeList=[])}),s.forEach(function(e,a){i[s[a]]&&i[s[a]].split(",").forEach(function(e,s){var i=6*parseInt(e.split("-")[0].split(":")[0])+parseInt(e.split("-")[0].split(":")[1])/10,n=6*parseInt(e.split("-")[1].split(":")[0])+parseInt(e.split("-")[1].split(":")[1])/10;t.allWeeks[a].timeList.push({timeQj:[i,n]})})})},tabclick:function(){var e=this;new c.a(function(t,s){e.$http.get(e.netAPI.accessDevice.findAllDevice,{params:{groupNo:e.$store.default.state.accessManage.groupData.groupNo,type:e.$store.default.state.accessManage.deviceType}}).then(function(s){200==s.body.status?(e.$store.default.state.accessManage.deviceList=s.body.data,t(s.body.data)):e.$message.error(s.body.message)})}).then(function(t){e.$http.get(e.netAPI.accessDevice.findDeviceAll,{params:{pageSize:1e3,pageNo:1}}).then(function(t){for(var s in t.body.data)if(t.body.data.hasOwnProperty(s)){var i=t.body.data[s];for(var a in e.$store.default.state.accessManage.deviceList)if(e.$store.default.state.accessManage.deviceList.hasOwnProperty(a)){var n=e.$store.default.state.accessManage.deviceList[a];i.deviceId==n.id&&e.$set(n,"isAdd","true")}}}),console.log(e.$store.default.state.accessManage.deviceList)})},addClose:function(){this.$store.state.accessManage.addList=[],this.dialogTableVisible=!1},openAll:function(){var e=this;this.$http.get(this.netAPI.accessDevice.openDoor).then(function(t){200==t.body.status?e.$message.success(e.$t("accessSystem.yikaimen")):e.$message.error(t.body.message)})},handleSelectionChange:function(e){console.log(e),e.length?this.multipleSelection=e:this.multipleSelection=[]},moreDelete:function(){var e=this,t=[];if(this.multipleSelection.length<1)this.$message.warning(this.$t("accessSystem.qingxuanzeshanchuxiang"));else{for(var s in this.multipleSelection)if(this.multipleSelection.hasOwnProperty(s)){var i=this.multipleSelection[s];t.push({id:i.id})}this.$http.post(this.netAPI.accessDevice.removeDevice,t).then(function(s){200==s.body.status?(e.$message.success(e.$t("accessSystem.shanchuchenggong")),console.log(e.tableData.length),1==e.tableData.length&&(e.pageNumber=e.pageNumber-1>0?e.pageNumber-1:1),t.length==s.body.data&&(e.pageNumber=e.pageNumber-1>0?e.pageNumber-1:1),e.getDeviceList()):e.$message.error(s.body.message)})}},farOpen:function(e){var t=this;this.$http.get(this.netAPI.accessDevice.openDoor,{params:{id:e.id}}).then(function(e){200==e.body.status?t.$message.success(t.$t("accessSystem.yikaimen")):t.$message.error(e.body.message)})},deleteDevice:function(e){var t=this;console.log(e),this.$http.post(this.netAPI.accessDevice.removeDevice,[{id:e.id}]).then(function(e){200==e.body.status?(t.$message.success(t.$t("accessSystem.shanchuchenggong")),1==t.tableData.length&&(t.pageNumber=t.pageNumber-1>0?t.pageNumber-1:1),t.getDeviceList()):t.$message.error(e.body.message)})},settingSubmit:function(){var e=this,t=JSON.parse(a()(this.allWeeks));t.forEach(function(e,s){e.timeList.forEach(function(e,i){var a=e.timeQj[0],n=e.timeQj[1],c=""+(a%6*10<10?"0"+a%6*10:a%6*10),o=""+(n%6*10<10?"0"+n%6*10:n%6*10);t[s].timeList[i].timeQj=Math.floor(a/6)+":"+c+"-"+Math.floor(n/6)+":"+o})});if(["mon","tue","wed","thu","fri","sat","sun"].forEach(function(s,i){var a="";t[i].timeList.forEach(function(e){a=a?a+","+e.timeQj:e.timeQj}),e.settingForm[s]=a}),this.settingForm.ids=this.settingIds,0==this.settingIds.length){console.log(this.multipleSelection);var s=[];for(var i in this.multipleSelection)if(this.multipleSelection.hasOwnProperty(i)){var n=this.multipleSelection[i];s.push(n.id)}this.settingForm.ids=s}console.log(this.settingIds),this.$http.post(this.netAPI.accessDevice.updateDevice,this.settingForm).then(function(t){200==t.body.status?(e.$message.success(e.$t("accessSystem.shezhichenggong")),e.getDeviceList(),e.settingDialogVisible=!1):(e.$message.error(t.body.message),e.settingDialogVisible=!1)})},insertDevice:function(){var e=this,t=[];for(var s in console.log(this.deviceAlreadyList,this.$store.state.accessManage.addList),this.$store.state.accessManage.addList)if(this.$store.state.accessManage.addList.hasOwnProperty(s)){var i=this.$store.state.accessManage.addList[s];for(var a in t.push(i.id),this.$store.default.state.accessManage.deviceAlreadyList){if(this.$store.default.state.accessManage.deviceAlreadyList.hasOwnProperty(a))this.$store.default.state.accessManage.deviceAlreadyList[a].deviceId==i.id&&(t.pop(),console.log(1))}}this.$http.post(this.netAPI.accessDevice.addDevices,{deviceIds:t}).then(function(t){200==t.body.status?(e.$message.success(e.$t("accessSystem.tianjiachenggong")),e.getDeviceList()):e.$message.error(t.body.message),e.addClose()})},deleteTag:function(e){console.log(e),this.$store.state.accessManage.addList.splice(this.$store.state.accessManage.addList.indexOf(e),1);for(var t=0;t<this.store.deviceList.length;t++){var s=this.store.deviceList[t];e.id==s.id&&(s.isAdd=!1,this.$set(this.store.deviceList,t,s))}},handleEdit:function(e,t){console.log(e),t.isAdd=!0,this.$set(this.store.deviceList,e,t),this.$store.state.accessManage.addList.push({name:t.name,id:t.id,closable:!0})},getDevices:function(){this.$http.get(this.netAPI.accessDevice.findAllDevice).then(function(e){})},openAdd:function(){this.dialogTableVisible=!0,this.$store.default.commit("freshData")},formatType:function(e,t){switch(e.deviceType){case 1:return this.$t("accessSystem.zhaoxiangji");case 2:return this.$t("accessSystem.luxiangji");case 3:return this.$t("accessSystem.zhinengyingjian")}},openSetting:function(e){!e.id&&this.multipleSelection.length<1?this.$message.warning(this.$t("accessSystem.qingxuanzeshezhixiang")):this.settingDialogVisible=!0,e.id&&this.settingIds.push(e.id),this.timeDataTransfer(e),this.settingForm.inOut=e.inOut},handleClose:function(){this.settingDialogVisible=!1,this.settingIds=[],console.log("close")},handleSizeChange:function(e){this.pageSize=e,this.getDeviceList()},handleCurrentChange:function(e){this.pageNumber=e,this.getDeviceList()},getDeviceList:function(){var e=this;this.$http.get(this.netAPI.accessDevice.findDeviceAll,{params:{pageSize:this.pageSize,pageNo:this.pageNumber,sort:"id",order:"asc"}}).then(function(t){console.log(t),e.tableData=t.body.data,e.total=t.body.total})},addTimeTip:function(e,t){this.allWeeks[e].timeList.length<4?this.$set(this.allWeeks[e].timeList,""+this.allWeeks[e].timeList.length,{timeQj:[0,144]}):this.$message.error(this.$t("accessSystem.meirishangxiansigeshijianduan"))},delTimeTip:function(e,t){this.allWeeks[e].timeList.splice(t,1)},tupTime:function(e,t){this.allWeeks[e].timeList=JSON.parse(a()(this.allWeeks[e-1].timeList))},filterTimeInterVal:function(e){var t=e[0],s=e[1],i=""+(t%6*10<10?"0"+t%6*10:t%6*10),a=""+(s%6*10<10?"0"+s%6*10:s%6*10);return Math.floor(t/6)+":"+i+"-"+Math.floor(s/6)+":"+a},formatTooltip:function(e){return e/100},formatTimetip:function(e){var t=""+(e%6*10<10?"0"+e%6*10:e%6*10);return Math.floor(e/6)+":"+t}},components:{selectGroup:o.a}},m={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"device_manage"}},[s("el-dialog",{attrs:{title:e.$t("accessSystem.shezhi"),visible:e.settingDialogVisible,width:"28%","before-close":e.handleClose},on:{"update:visible":function(t){e.settingDialogVisible=t}}},[s("el-form",{staticClass:"form",attrs:{"label-position":"left","label-width":"70px",model:e.settingForm}},[s("div",{staticClass:"content-set"},e._l(e.allWeeks,function(t,i){return s("div",{key:i},[s("div",{staticClass:"week-word"},[e._v(e._s(t.name))]),e._v(" "),e._l(t.timeList,function(t,a){return s("div",{key:a,staticClass:"week-line"},[s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:18}},[s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:16}},[s("el-slider",{attrs:{range:"",label:"","format-tooltip":e.formatTimetip,max:144},model:{value:t.timeQj,callback:function(s){e.$set(t,"timeQj",s)},expression:"item.timeQj"}})],1),e._v(" "),s("el-col",{staticStyle:{"margin-top":"3px"},attrs:{span:8}},[s("div",{staticClass:"show-time"},[e._v(e._s(e.filterTimeInterVal(t.timeQj)))])])],1)],1),e._v(" "),s("el-col",{staticStyle:{"margin-top":"3px"},attrs:{span:6}},[0!=a?s("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){e.delTimeTip(i,a)}}},[e._v(e._s(e.$t("accessSystem.shanchu")))]):e._e(),e._v(" "),0===a?s("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){e.addTimeTip(i,a)}}},[e._v(e._s(e.$t("accessSystem.xinzeng")))]):e._e(),e._v(" "),0!==i&&0===a?s("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){e.tupTime(i,a)}}},[e._v(e._s(e.$t("accessSystem.tongshang")))]):e._e()],1)],1)],1)})],2)})),e._v(" "),s("el-form-item",{staticStyle:{"margin-top":"10px"},attrs:{label:e.$t("accessSystem.jinchuleixing"),"label-width":"100"}},[s("el-select",{staticClass:"select",attrs:{placeholder:e.$t("accessSystem.jinchuleixing")},model:{value:e.settingForm.inOut,callback:function(t){e.$set(e.settingForm,"inOut",t)},expression:"settingForm.inOut"}},[s("el-option",{attrs:{label:e.$t("accessSystem.jin"),value:1}}),e._v(" "),s("el-option",{attrs:{label:e.$t("accessSystem.chu"),value:0}})],1)],1)],1),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.settingSubmit}},[e._v(e._s(e.$t("accessSystem.queding")))])],1),e._v(" "),s("div",{staticClass:"contantHeader"},[s("el-dialog",{staticClass:"diglog",attrs:{title:e.$t("accessSystem.tianjiashebei"),visible:e.dialogTableVisible,width:"47%","before-close":e.addClose},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[s("select-group",{ref:"treemenu",staticClass:"tree"}),e._v(" "),s("div",{staticClass:"deviceList"},[s("el-tabs",{attrs:{type:"card"},on:{"tab-click":e.tabclick},model:{value:e.$store.state.accessManage.deviceType,callback:function(t){e.$set(e.$store.state.accessManage,"deviceType",t)},expression:"$store.state.accessManage.deviceType"}},[s("el-tab-pane",{attrs:{label:e.$t("accessSystem.shexiangji"),name:"1"}}),e._v(" "),s("el-tab-pane",{attrs:{label:e.$t("accessSystem.zhinengyingjian"),name:"3"}})],1),e._v(" "),s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.$store.state.accessManage.deviceList,size:"mini",height:"400"}},[s("el-table-column",{attrs:{label:e.$t("accessSystem.mingcheng"),width:"180",prop:"name"}}),e._v(" "),s("el-table-column",{attrs:{label:e.$t("accessSystem.caozuo"),width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{size:"mini",disabled:t.row.isAdd},on:{click:function(s){e.handleEdit(t.$index,t.row)}}},[e._v(e._s(e.$t("accessSystem.tianjia")))])]}}])})],1)],1),e._v(" "),s("div",{staticClass:"tags"},[s("div",e._l(e.$store.state.accessManage.addList,function(t){return s("el-tag",{key:t.id,attrs:{closable:t.closable,"disable-transitions":!1},on:{close:function(s){e.deleteTag(t)}}},[e._v("\n            "+e._s(t.name)+"\n          ")])})),e._v(" "),s("div",[s("el-button",{attrs:{type:"primary"},on:{click:e.insertDevice}},[e._v(e._s(e.$t("accessSystem.queding")))])],1)])],1),e._v(" "),s("span",{staticClass:"title"},[e._v(e._s(e.$t("accessSystem.menjinshebei")))]),e._v(" "),s("div",{staticStyle:{display:"inline-block",float:"right","margin-right":"0.64rem"}},[s("el-button",{attrs:{round:""},on:{click:e.openAdd}},[e._v(e._s(e.$t("accessSystem.xinzeng")))]),e._v(" "),s("el-button",{attrs:{round:""},on:{click:e.moreDelete}},[e._v(e._s(e.$t("accessSystem.shanchu")))]),e._v(" "),s("el-button",{attrs:{round:""},on:{click:e.openSetting}},[e._v(e._s(e.$t("accessSystem.shezhi")))]),e._v(" "),s("el-button",{staticClass:"btn",attrs:{round:"",type:"primary"},on:{click:e.openAll}},[e._v(e._s(e.$t("accessSystem.xiaofangkaimen")))])],1)],1),e._v(" "),s("div",{staticClass:"contantTable"},[s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,"row-key":e.getRowKeys},on:{"selection-change":e.handleSelectionChange}},[s("el-table-column",{attrs:{type:"selection",width:"55","reserve-selection":!0}}),e._v(" "),s("el-table-column",{attrs:{type:"index",width:"50"}}),e._v(" "),s("el-table-column",{attrs:{prop:"deviceName",label:e.$t("accessSystem.shebeimingcheng")}}),e._v(" "),s("el-table-column",{attrs:{prop:"deviceType",label:e.$t("accessSystem.leixing"),formatter:e.formatType}}),e._v(" "),s("el-table-column",{attrs:{label:e.$t("accessSystem.gongzuoshijian")},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-popover",{attrs:{placement:"left-start",trigger:"hover"}},[s("span",{attrs:{slot:"reference"},slot:"reference"},[e._v(e._s(e.$t("accessSystem.zhouyi"))+" "+e._s(t.row.mon)+e._s(e.$t("accessSystem.dian"))+"......")]),e._v(" "),s("p",[e._v(e._s(e.$t("accessSystem.zhouyi"))+" "+e._s(t.row.mon))]),e._v(" "),s("p",[e._v(e._s(e.$t("accessSystem.zhouer"))+" "+e._s(t.row.tue))]),e._v(" "),s("p",[e._v(e._s(e.$t("accessSystem.zhousan"))+" "+e._s(t.row.wed))]),e._v(" "),s("p",[e._v(e._s(e.$t("accessSystem.zhousi"))+" "+e._s(t.row.thu))]),e._v(" "),s("p",[e._v(e._s(e.$t("accessSystem.zhouwu"))+" "+e._s(t.row.fri))]),e._v(" "),s("p",[e._v(e._s(e.$t("accessSystem.zhouliu"))+" "+e._s(t.row.sat))]),e._v(" "),s("p",[e._v(e._s(e.$t("accessSystem.zhouri"))+" "+e._s(t.row.sun))])])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:e.$t("accessSystem.caozuo")},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(s){e.openSetting(t.row)}}},[e._v(e._s(e.$t("accessSystem.shezhi")))]),e._v(" "),s("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(s){e.farOpen(t.row)}}},[e._v(e._s(e.$t("accessSystem.yuanchengkaimen")))]),e._v(" "),s("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(s){e.deleteDevice(t.row)}}},[e._v(e._s(e.$t("accessSystem.shanchu")))])]}}])})],1),e._v(" "),s("el-pagination",{staticClass:"pagination",attrs:{"current-page":e.pageNumber,"page-sizes":[5,10,20,40],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.pageNumber=t}}})],1)],1)},staticRenderFns:[]};var h=s("VU/8")(r,m,!1,function(e){s("akXI"),s("Fdzg")},"data-v-3f82b554",null);t.default=h.exports},Fdzg:function(e,t){},akXI:function(e,t){}});
//# sourceMappingURL=16.eb707a31d03ed8198c3d.js.map