webpackJsonp([14],{"/YOH":function(e,t){},"5EID":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("mvHQ"),r=a.n(i),s=a("4syG"),o=a("2hMI"),l={components:{separator:s.a},data:function(){return{token:"",allNotIncludeHardware:[],adminIncludeHardware:[],adminIncludeHardwareNames:[],adminNotIncludeHardWare:[],createHardwareNameArr:[],updateHardwareNameArr:[],updateDeviceArr:[],multipleSelection:[],batchdisabled:!0,tableBoxLoading:!1,adminId:"",currentPage:1,pageSize:5,total:0,createform:{name:"",photo:"",password:"",deviceIds:[]},updateform:{id:"",name:"",photo:"",password:"",deviceIds:[],mappingIds:[]},deleteData:[],deviceManagerDtosform:{id:""},search:{},adddialogVisible:!1,updateialogVisible:!1,dialogVisible:!1,dialogImageUrl:"",netAPI:"",hardwareNetAPI:"",tableData:[],allAdministrator:[],deviceManagerDtosData:[],ids:0,form:"",createFilelist:[],updateFilelist:[],createfilechange:!1,imageUrl:!0,filechange:!1,validUpdate:!1,pageNumber:0,pageNo:1,isUp:!0,getRowKeys:function(e){return e.id}}},computed:{createRules:function(){return{name:[{required:!0,message:this.$t("deviceList.please")+this.$t("deviceAdministrator.nameA"),trigger:"blur"}],password:[{required:!0,message:this.$t("deviceList.please")+this.$t("deviceAdministrator.passwordA"),trigger:"blur"}]}},updateRules:function(){return{name:[{required:!0,message:this.$t("deviceList.please")+this.$t("deviceAdministrator.nameA"),trigger:"blur"}],password:[{required:!0,message:this.$t("deviceList.please")+this.$t("deviceAdministrator.passwordA"),trigger:"blur"}]}}},created:function(){this.netAPI=Object(o.a)().get("device_administrator"),this.hardwareNetAPI=Object(o.a)().get("device"),this.getNotIncludeHardware(),this.searchtabledata(),console.log(this.$route.meta.remove)},methods:{beforeCreateUpload:function(e){console.log(e);var t="image/jpeg"===e.type,a=e.size/1024/1024<1;return"image/jpeg"!==e.type&&"image/png"!==e.type&&(this.$message.error("上传头像只能是图片!"),this.isUp=!1),a||(this.$message.error("上传头像图片大小不能超过 1MB!"),this.isUp=!1),t&&a},beforeUpdateUpload:function(e){console.log(e);var t="image/jpeg"===e.type,a=e.size/1024/1024<1;return"image/jpeg"!==e.type&&"image/png"!==e.type&&(this.$message.error("上传头像只能是图片!"),this.isUp=!1),a||(this.$message.error("上传头像图片大小不能超过 1MB!"),this.isUp=!1),t&&a},filterselectable:function(e,t){return this.$route.meta.remove?1:0},handlePictureCardPreview:function(e){this.dialogImageUrl=e.url,this.dialogVisible=!0},searchtabledata:function(){var e=this;this.tableBoxLoading=!0,this.search.pageSize=this.pageSize,this.search.pageNo=this.currentPage,this.$http.get(this.netAPI.find,{params:this.search}).then(function(t){200==t.body.status?(e.tableData=t.body.data,e.total=t.body.total,e.pageNumber=t.body.pageNumber,e.tableBoxLoading=!1):e.$message.warning(e.$t("common.findFailed")+t.body.message)},function(t){e.$message({message:e.$t("common.serviceError")+t,type:"warning"})})},getNotIncludeHardware:function(e){var t=this;this.$http.get(this.netAPI.findnotincludedevices,{params:{id:""}}).then(function(a){200==a.body.status?(t.allNotIncludeHardware=a.body.data,"update"==e&&t.findAdminIncludeHardWare()):t.$message.warning(t.$t("common.findFailed")+a.body.message)})},openaddAdministrator:function(){this.createHardwareNameArr=[],this.createFilelist=[],this.adddialogVisible=!0},createdfrom:function(e){var t=this,a=JSON.parse(r()(this.createform));this.$refs[e].validate(function(e){if(!e)return!1;a.deviceIds=[],t.allNotIncludeHardware.forEach(function(e){t.createHardwareNameArr.forEach(function(t){e.name==t&&a.deviceIds.push(e.id)})}),t.$http.post(t.netAPI.insert,a).then(function(e){200==e.body.status?(t.$refs.createform.resetFields(),t.$refs.createFile.clearFiles(),t.adddialogVisible=!1,t.$message.success(t.$t("common.insertSuccess")),t.searchtabledata()):t.$message.warning(t.$t("common.insertFailed")+e.body.message)},function(e){t.$message({message:t.$t("common.serviceError")+e,type:"warning"})})})},findAdminIncludeHardWare:function(){var e=this;this.adminIncludeHardwareNames=[],this.updateform.mappingIds=[],this.$http.get(this.netAPI.findincludeddevices,{params:{id:this.adminId}}).then(function(t){200==t.body.status?(e.adminIncludeHardware=t.body.data,t.body.data.forEach(function(t){e.adminIncludeHardwareNames.push(t.deviceName)}),e.allNotIncludeHardware.forEach(function(a){t.body.data.forEach(function(t){a.name==t.deviceName&&e.updateform.mappingIds.push(t.id)})})):e.$message.warning(e.$t("common.findFailed")+t.body.message)},function(t){e.$message({message:e.$t("common.serviceError")+t,type:"warning"})})},updateopen:function(e){this.adminId=e.id,this.updateform.id=e.id,this.updateform.name=e.name,this.updateform.photo=e.photo,this.updateform.password=e.password,this.getNotIncludeHardware("update"),this.updateialogVisible=!0},updatedForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.updateform.deviceIds=[],t.allNotIncludeHardware.forEach(function(e){t.adminIncludeHardwareNames.forEach(function(a){e.name==a&&t.updateform.deviceIds.push(e.id)})}),t.$http.post(t.netAPI.modify,t.updateform).then(function(e){200==e.body.status?(t.$message.success(t.$t("common.updateSuccess")),t.searchtabledata()):t.$message.warning(t.$t("common.updateFailed")+e.body.message),t.updateialogVisible=!1},function(e){t.$message({message:t.$t("common.serviceError")+e,type:"warning"}),t.updateialogVisible=!1})})},canceldialogVisible:function(e){this.$refs.createFile.clearFiles(),this.$refs[e].resetFields(),this.createFilelist=[],this.createHardwareNameArr=[],this.adddialogVisible=!1},createFileHandleClose:function(e){this.$refs.createform.resetFields(),this.$refs.createFile.clearFiles(),this.createFilelist=[],this.createHardwareNameArr=[],e()},updatecanceldialogVisible:function(e){this.$refs.updateform.resetFields(),this.$refs.updateFile.clearFiles(),this.updateialogVisible=!1,this.updateDeviceArr=[],this.updateFilelist=[]},updateformHandleClose:function(e){this.$refs.updateform.resetFields(),this.$refs.updateFile.clearFiles(),this.updateDeviceArr=[],this.updateFilelist=[],e()},handleSizeChange:function(e){this.pageSize=e,this.searchtabledata()},handleCurrentChange:function(e){this.currentPage=e,this.searchtabledata()},updateformRemove:function(){this.createfilechange=!1},createEtformRemove:function(){this.createFilelist=[],delete this.createform.photo},updateEtformRemove:function(){this.updateFilelist=[],delete this.updateform.photo,this.imageUrl=!1},createchange:function(e,t){var a=new FileReader;a.readAsDataURL(e.raw);var i=this;a.onload=function(e){i.createform.photo=this.result},this.createFilelist.push(e)},updatechange:function(e,t){console.log(123),console.log(345);var a=new FileReader;a.readAsDataURL(e.raw);var i=this;a.onload=function(e){i.updateform.photo=this.result},this.updateFilelist.push(e)},handleSelectionChange:function(e){e.length>0?(this.$refs.batchremove.$el.style.color="black",this.batchdisabled=!1):(this.$refs.batchremove.$el.style.color="#BABABA",this.batchdisabled=!0),this.multipleSelection=e},deleteRow:function(e){var t=this;if(this.deleteData=[],1==e instanceof Array)for(var a in e)this.deleteData.push({id:e[a].id});else this.deleteData.push({id:e.id});this.$confirm(this.$t("delete.deleteRow"),this.$t("delete.tips"),{confirmButtonText:this.$t("delete.ok"),cancelButtonText:this.$t("delete.cancel"),type:"warning"}).then(function(){t.$http.post(t.netAPI.delete,t.deleteData).then(function(e){200==e.body.status?(t.deleteData.length==t.tableData.length?(t.currentPage=t.currentPage-1>0?t.currentPage-1:1,t.searchtabledata()):t.searchtabledata(),t.$message.success(t.$t("delete.success")),t.$refs.admintable.clearSelection()):t.$message.warning(t.$t("common.deleteFailed")+e.body.message)},function(e){t.$message({message:t.$t("common.serviceError")+e,type:"warning"})})}).catch(function(){t.$message({type:"info",message:t.$t("delete.canceledDeletion")})})},createExhibition:function(e){console.log(e)},updateExhibition:function(e){}}},n={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"admin-page"},[a("separator"),e._v(" "),a("div",{staticClass:"admin-content"},[a("div",{staticClass:"operation-box"},[a("i",{staticClass:"blue"}),e._v(" "),a("div",{staticClass:"title"},[a("span",[e._v(e._s(e.$t("deviceAdministrator.administrator")))])]),e._v(" "),a("div",{staticClass:"operation"},[a("el-button",{staticClass:"addButton",attrs:{disabled:!e.$route.meta.add},on:{click:e.openaddAdministrator}},[e._v(e._s(e.$t("deviceAdministrator.added")))]),e._v(" "),a("el-button",{ref:"batchremove",staticStyle:{color:"#BABABA"},attrs:{disabled:e.batchdisabled},on:{click:function(t){e.deleteRow(e.multipleSelection)}}},[e._v(e._s(e.$t("common.batchDeletion")))])],1)]),e._v(" "),a("div",{staticClass:"table-box"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableBoxLoading,expression:"tableBoxLoading"}],ref:"admintable",attrs:{data:e.tableData,height:"500","header-cell-style":{background:"rgba(245,248,252,1)"},"row-key":e.getRowKeys},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{fixed:"",type:"selection",width:"80",align:"center","reserve-selection":"",selectable:e.filterselectable}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:e.$t("deviceAdministrator.name"),align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"photo",label:e.$t("deviceAdministrator.photo"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{ref:"popover",attrs:{placement:"bottom",title:"",trigger:"click"}},[a("img",{staticStyle:{"max-width":"800px","max-height":"600px"},attrs:{src:t.row.photo,alt:""}}),e._v(" "),t.row.photo?a("img",{staticStyle:{width:"50px",height:"50px",cursor:"pointer"},attrs:{slot:"reference",src:t.row.photo,alt:"",srcset:""},slot:"reference"}):e._e()])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"password",label:e.$t("deviceAdministrator.password"),align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:e.$t("common.operation"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small",disabled:!e.$route.meta.modify},on:{click:function(a){e.updateopen(t.row)}}},[e._v(e._s(e.$t("common.edit")))]),e._v(" "),a("el-button",{attrs:{type:"text",size:"small",disabled:!e.$route.meta.remove},on:{click:function(a){e.deleteRow(t.row)}}},[e._v(e._s(e.$t("common.delete")))])]}}])})],1),e._v(" "),a("div",{staticClass:"pagination-box"},[a("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[5,10,20],"page-size":e.pageSize,layout:"total, prev, pager, next, sizes, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:pageSize":function(t){e.pageSize=t}}})],1)],1),e._v(" "),a("el-dialog",{attrs:{title:e.$t("deviceAdministrator.modify"),visible:e.adddialogVisible,width:"575px","before-close":e.createFileHandleClose},on:{"update:visible":function(t){e.adddialogVisible=t}}},[a("el-form",{ref:"createform",attrs:{rules:e.updateRules,model:e.createform,"label-width":"100px","label-position":"left"}},[a("el-form-item",{attrs:{label:e.$t("deviceAdministrator.nameA"),prop:"name"}},[a("el-input",{attrs:{placeholder:e.$t("deviceAdministrator.enterName")},model:{value:e.createform.name,callback:function(t){e.$set(e.createform,"name",t)},expression:"createform.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("deviceAdministrator.photoA"),prop:"photo"}},[a("el-upload",{ref:"createFile",class:1==e.createFilelist.length?"noShow":"show",attrs:{action:"","before-upload":e.beforeCreateUpload,"on-remove":e.createEtformRemove,"on-change":e.createchange,"on-preview":e.handlePictureCardPreview,limit:1,"file-list":e.createFilelist,"list-type":"picture-card",multiple:!1,"http-request":e.createExhibition}},[a("i",{staticClass:"el-icon-plus"})])],1),e._v(" "),a("el-dialog",{attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})]),e._v(" "),a("el-form-item",{attrs:{label:e.$t("deviceAdministrator.passwordA"),prop:"password"}},[a("el-input",{attrs:{placeholder:e.$t("deviceAdministrator.passwordA")},model:{value:e.createform.password,callback:function(t){e.$set(e.createform,"password",t)},expression:"createform.password"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("deviceAdministrator.associated"),"label-width":"zh"==e.$i18n.locale?"100px":"130px"}},[a("el-select",{attrs:{clearable:"",multiple:"",filterable:"",placeholder:e.$t("deviceAdministrator.associated")},model:{value:e.createHardwareNameArr,callback:function(t){e.createHardwareNameArr=t},expression:"createHardwareNameArr"}},e._l(e.allNotIncludeHardware,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.name}})}))],1),e._v(" "),a("el-form-item",{staticClass:"sub",staticStyle:{"text-align":"right"}},[a("el-button",{on:{click:function(t){e.canceldialogVisible("createform")}}},[e._v(e._s(e.$t("common.cancel")))]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.createdfrom("createform")}}},[e._v(e._s(e.$t("common.ok")))])],1)],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"修改管理员",visible:e.updateialogVisible,width:"575px","before-close":e.updateformHandleClose},on:{"update:visible":function(t){e.updateialogVisible=t}}},[a("el-form",{ref:"updateform",attrs:{rules:e.createRules,model:e.updateform,"label-width":"100px","label-position":"left"}},[a("el-form-item",{attrs:{label:e.$t("deviceAdministrator.nameA"),prop:"name"}},[a("el-input",{model:{value:e.updateform.name,callback:function(t){e.$set(e.updateform,"name",t)},expression:"updateform.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("deviceAdministrator.photoA"),prop:"photo"}},[a("el-upload",{ref:"updateFile",class:1==e.updateFilelist.length?"noShow":"show",attrs:{"before-upload":e.beforeUpdateUpload,"on-remove":e.updateEtformRemove,"on-change":e.updatechange,"on-preview":e.handlePictureCardPreview,limit:1,"file-list":e.updateFilelist,action:"","list-type":"picture-card",multiple:!1,"http-request":e.updateExhibition}},[e.updateform.photo?a("img",{staticClass:"avatar",attrs:{src:e.updateform.photo,width:"100%"}}):a("i",{staticClass:"el-icon-plus"})])],1),e._v(" "),a("el-dialog",{attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})]),e._v(" "),a("el-form-item",{attrs:{label:e.$t("deviceAdministrator.passwordA"),prop:"password"}},[a("el-input",{model:{value:e.updateform.password,callback:function(t){e.$set(e.updateform,"password",t)},expression:"updateform.password"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("deviceAdministrator.associatedA"),"label-width":"zh"==e.$i18n.locale?"100px":"130px"}},[a("el-select",{attrs:{clearable:"",multiple:"",filterable:""},model:{value:e.adminIncludeHardwareNames,callback:function(t){e.adminIncludeHardwareNames=t},expression:"adminIncludeHardwareNames"}},e._l(e.allNotIncludeHardware,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.name}})}))],1),e._v(" "),a("el-form-item",{staticClass:"sub",staticStyle:{"text-align":"right"}},[a("el-button",{on:{click:function(t){e.updatecanceldialogVisible("updateform")}}},[e._v(e._s(e.$t("common.cancel")))]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.updatedForm("updateform")}}},[e._v(e._s(e.$t("common.ok")))])],1)],1)],1)],1)],1)},staticRenderFns:[]};var d=a("VU/8")(l,n,!1,function(e){a("a0mX"),a("/YOH")},"data-v-77503888",null);t.default=d.exports},a0mX:function(e,t){}});
//# sourceMappingURL=14.2db3db5c4ac555e349ec.js.map